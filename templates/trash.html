{% extends "base.html" %}
{% block content %}
  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h5 class="mb-0">{{ t('trash.title') }}</h5>
      <a href="{{ url_for('browse') }}" class="text-muted text-decoration-none"><i class="bi bi-arrow-left"></i> {{ t('nav.files') }}</a>
    </div>
    {% if items %}
    <form action="{{ url_for('trash_empty') }}" method="post" onsubmit="return confirm('{{ t('trash.confirm_empty') }}')">
      <button type="submit" class="btn btn-danger btn-sm">
        <i class="bi bi-trash-fill"></i> {{ t('trash.empty') }}
      </button>
    </form>
    {% endif %}
  </div>

  <div class="table-responsive">
    <table class="table table-dark table-striped table-hover table-sm align-middle">
      <thead>
        <tr>
          <th>{{ t('table.name') }}</th>
          <th>{{ t('trash.original_path') }}</th>
          <th>{{ t('table.size') }}</th>
          <th>{{ t('trash.deleted_at') }}</th>
          <th>{{ t('table.actions') }}</th>
        </tr>
      </thead>
      <tbody>
      {% for item in items %}
        <tr>
          <td class="monospace">
            {% if item.is_dir %}
              <i class="bi bi-folder-fill text-warning me-2"></i>
            {% else %}
              <i class="bi bi-file-earmark-text me-2"></i>
            {% endif %}
            {{ item.display_name }}
          </td>
          <td class="text-muted small">{{ item.original_path }}</td>
          <td>{{ item.size|bytes_human if not item.is_dir else "-" }}</td>
          <td>{{ item.date_str }}</td>
          <td>
            <div class="d-flex gap-2">
                <form action="{{ url_for('trash_restore') }}" method="post">
                    <input type="hidden" name="name" value="{{ item.name }}">
                    <button type="submit" class="btn btn-sm btn-outline-success btn-icon" title="{{ t('trash.restore') }}">
                        <i class="bi bi-arrow-counterclockwise"></i>
                    </button>
                </form>
                <form action="{{ url_for('trash_delete') }}" method="post" onsubmit="return confirm('{{ t('trash.confirm_delete') }}')">
                    <input type="hidden" name="name" value="{{ item.name }}">
                    <button type="submit" class="btn btn-sm btn-outline-danger btn-icon" title="{{ t('trash.delete') }}">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </form>
            </div>
          </td>
        </tr>
      {% else %}
        <tr>
            <td colspan="5" class="text-center text-muted py-5">
                <i class="bi bi-trash display-4 mb-3 d-block"></i>
                {{ t('trash.is_empty') }}
            </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}